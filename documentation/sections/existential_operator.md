## 存在運算子

在 JavaScript 要檢查一個變數是否存在其實有點小聒噪。`if (變數) ...` 什麼的，然後就跟一些資料型態有關，像是：零值、空字串、假值（有很多不同的檢測方式）。所以 CoffeeScript 的 `?` 存在運算子就這樣產生了。除非一個變數是 `null` 或者 `undefined` 甚至尚未定義，否則都會回傳 `true`。這有點像是 Ruby 的 `nil?` 用法。

這個方式也能夠被用在 JavaScript 中類似 `a = a || value` 的場景作為更安全的條件式比較，不然通常來說都需要額外檢查數值或字串實在是有點麻煩。

```
codeFor('existence', 'footprints')
```

不過要注意的是：當編譯器得知 `a` 已經在有效範圍中被定義時，`a?` 會被編譯成 `a != null` _而不是_ `a !== null`。因為 `!=` 能夠以較寬鬆的方式檢查該變數是否與 `null` 相符，這同時也能夠雙重保障該變數並不是一個 `undefined`。這個道理同樣適用於 `not a?` 和 `unless a?` 語法。

```
codeFor('existence_declared')
```

當一個變數可能不會被定義時，JavaScript 工程師 _應該_ 要寫得像下面一樣來檢查該變數到底存不存在。

```
codeFor('existence_undeclared')
```

存在運算子 `?.` 也可以用於一個可能是空值物件的方法鏈中。如果想要避免呼叫到 `null` 或 `undefined` 物件方法就可以透過 `?.` 來取代普通的 `.` 作為串連符號。當連結鏈因為前一個物件不存在而錯誤時，就會回傳一個·`undefined` 而不是發生 `TypeError` 錯誤。

```
codeFor('soaks')
```

具體來說：

| 範例 | 定義 |
| --- | --- |
| `a?` | 確保 `a` 處於有效範圍中並且 `a != null` |
| `a ? b` | 如果 `a` 存在且 `a != null` 的話則回傳 `a`；否則就回傳 `b` |
| `a?.b` 或 `a?['b']` | 如果 `a` 存在且 `a != null` 的話就回傳 `a.b`；否則就回傳 `undefined` |
| `a?(b, c)` 或 `a? b, c`&emsp; | 如果 `a` 存在並且是可供呼叫的話則將參數 `b` 和 `c` 傳入並呼叫；否則回傳 `undefined` |
| `a ?= b` | 如果 `a` 不存在於有效範圍內或者 `a == null` 的話就將 `b` 的值賦予給 `a`；簡單說就是不存在就定義 `a` 變數 |